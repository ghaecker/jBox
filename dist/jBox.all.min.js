!function(root,factory){"function"==typeof define&&define.amd?define([],factory):"object"==typeof module&&module.exports?module.exports=factory():root.unscroll=factory()}("undefined"!=typeof self?self:this,function(){function unscroll(elements){if(this.set=function(id,value){window.unscrollStore||(window.unscrollStore={}),window.unscrollStore[id]=value},this.get=function(id){return window.unscrollStore?window.unscrollStore[id]:null},this.getScrollbarWidth=function(){if(this.get("scrollbarWidth"))return this.get("scrollbarWidth")+"px";var scrollElement=document.createElement("div");scrollElement.style.width="100px",scrollElement.style.height="100px",scrollElement.style.overflow="scroll",scrollElement.style.position="absolute",scrollElement.style.top="-10000",document.body.appendChild(scrollElement);var scrollbarWidth=scrollElement.offsetWidth-scrollElement.clientWidth;return document.body.removeChild(scrollElement),this.set("scrollbarWidth",scrollbarWidth),scrollbarWidth+"px"},this.getElementsToAdjust=function(elements){elements||(elements=[]),"string"==typeof elements&&(elements=[[elements,"padding-right"]]),elements.forEach(function(element,index){"string"==typeof element&&(elements[index]=[element,"padding-right"])});for(var bodyFound=!1,i=0;i<elements.length;i++)-1!==elements[i][0].indexOf("body")&&(bodyFound=!0);return!1===bodyFound&&elements.push(["body","padding-right"]),elements},this.pageHasScrollbar=function(){return this.getScrollbarWidth()&&document.body.offsetHeight>window.innerHeight},this.pageHasScrollbar()){elements=this.getElementsToAdjust(elements);for(var i=0;i<elements.length;i++)for(var elementsDOM=document.querySelectorAll(elements[i][0]),j=0;j<elementsDOM.length;j++){if(elementsDOM[j].getAttribute("data-unscroll"))return;var attribute=elements[i][1],computedStyle=window.getComputedStyle(elementsDOM[j]).getPropertyValue(attribute);elementsDOM[j].setAttribute("data-unscroll",attribute),computedStyle||(computedStyle="0px");var operator="padding-right"==attribute||"right"==attribute?"+":"-";elementsDOM[j].style[attribute]="calc("+computedStyle+" "+operator+" "+this.getScrollbarWidth()+")"}}!function(){if(!document.getElementById("unscroll-class-name")){var head=document.head||document.getElementsByTagName("head")[0],style=document.createElement("style");style.type="text/css",style.setAttribute("id","unscroll-class-name"),style.appendChild(document.createTextNode(".unscrollable { overflow-y: hidden !important; }")),head.appendChild(style)}}(),document.body.classList.add("unscrollable")}return unscroll.reset=function(){for(var elements=document.querySelectorAll("[data-unscroll]"),i=0;i<elements.length;i++){var attribute=elements[i].getAttribute("data-unscroll");elements[i].style[attribute]=null,elements[i].removeAttribute("data-unscroll")}document.body.classList.remove("unscrollable")},unscroll}),function(root,factory){"function"==typeof define&&define.amd?define(["jquery"],function(jQuery){return root.jBox=factory(jQuery)}):"object"==typeof module&&module.exports?module.exports=root.jBox=factory(require("jquery")):root.jBox=factory(root.jQuery)}(this,function(jQuery){function jBox(type,options){var prefixes;return this.options={id:null,width:"auto",height:"auto",minWidth:null,minHeight:null,maxWidth:null,maxHeight:null,responsiveWidth:!0,responsiveHeight:!0,responsiveMinWidth:100,responsiveMinHeight:100,attach:null,trigger:"click",preventDefault:!1,content:null,getContent:null,title:null,getTitle:null,footer:null,isolateScroll:!0,ajax:{url:null,data:"",reload:!1,getURL:"data-url",getData:"data-ajax",setContent:!0,loadingClass:!0,spinner:!0,spinnerDelay:300,spinnerReposition:!0},cancelAjaxOnClose:!0,target:null,position:{x:"center",y:"center"},outside:null,offset:0,attributes:{x:"left",y:"top"},fixed:!1,adjustPosition:!0,adjustTracker:!1,adjustDistance:5,reposition:!0,repositionOnOpen:!0,repositionOnContent:!0,holdPosition:!0,pointer:!1,pointTo:"target",fade:180,animation:null,theme:"Default",addClass:null,overlay:!1,zIndex:1e4,delayOpen:0,delayClose:0,closeOnEsc:!1,closeOnClick:!1,closeOnMouseleave:!1,closeButton:!1,appendTo:jQuery("body"),createOnInit:!1,blockScroll:!1,blockScrollAdjust:!0,draggable:!1,dragOver:!0,autoClose:!1,delayOnHover:!1,showCountdown:!1,preloadAudio:!0,audio:null,volume:100,onInit:null,onAttach:null,onPosition:null,onCreated:null,onOpen:null,onClose:null,onCloseComplete:null,onDragStart:null,onDragEnd:null},this._pluginOptions={Tooltip:{getContent:"title",trigger:"mouseenter",position:{x:"center",y:"top"},outside:"y",pointer:!0},Mouse:{responsiveWidth:!1,responsiveHeight:!1,adjustPosition:"flip",target:"mouse",trigger:"mouseenter",position:{x:"right",y:"bottom"},outside:"xy",offset:5},Modal:{target:jQuery(window),fixed:!0,blockScroll:!0,closeOnEsc:!0,closeOnClick:"overlay",closeButton:!0,overlay:!0,animation:"zoomIn"}},this.options=jQuery.extend(!0,this.options,this._pluginOptions[type]?this._pluginOptions[type]:jBox._pluginOptions[type],options),"string"==jQuery.type(type)&&(this.type=type),this.isTouchDevice=(prefixes=" -webkit- -moz- -o- -ms- ".split(" "),!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)||function(query){return window.matchMedia(query).matches}(["(",prefixes.join("touch-enabled),("),"heartz",")"].join(""))),this.isTouchDevice&&"mouseenter"===this.options.trigger&&!1===this.options.closeOnClick&&(this.options.closeOnClick="body"),this._fireEvent=function(event,pass){this.options["_"+event]&&this.options["_"+event].bind(this)(pass),this.options[event]&&this.options[event].bind(this)(pass)},null===this.options.id&&(this.options.id="jBox"+jBox._getUniqueID()),this.id=this.options.id,("center"==this.options.position.x&&"x"==this.options.outside||"center"==this.options.position.y&&"y"==this.options.outside)&&(this.options.outside=null),"target"!=this.options.pointTo||this.options.outside&&"xy"!=this.options.outside||(this.options.pointer=!1),"object"!=jQuery.type(this.options.offset)?this.options.offset={x:this.options.offset,y:this.options.offset}:this.options.offset=jQuery.extend({x:0,y:0},this.options.offset),"object"!=jQuery.type(this.options.adjustDistance)?this.options.adjustDistance={top:this.options.adjustDistance,right:this.options.adjustDistance,bottom:this.options.adjustDistance,left:this.options.adjustDistance}:this.options.adjustDistance=jQuery.extend({top:5,left:5,right:5,bottom:5},this.options.adjustDistance),this.outside=!(!this.options.outside||"xy"==this.options.outside)&&this.options.position[this.options.outside],this.align=this.outside?this.outside:"center"!=this.options.position.y&&"number"!=jQuery.type(this.options.position.y)?this.options.position.x:"center"!=this.options.position.x&&"number"!=jQuery.type(this.options.position.x)?this.options.position.y:this.options.attributes.x,this.options.overlay&&"auto"!==this.options.zIndex&&(this.options.zIndex="auto"),jBox.zIndexMax=Math.max(jBox.zIndexMax||0,"auto"===this.options.zIndex?1e4:this.options.zIndex),"auto"===this.options.zIndex&&(this.adjustZIndexOnOpen=!0,jBox.zIndexMax+=2,this.options.zIndex=jBox.zIndexMax,this.trueModal=this.options.overlay),this._getOpp=function(opp){return{left:"right",right:"left",top:"bottom",bottom:"top",x:"y",y:"x"}[opp]},this._getXY=function(xy){return{left:"x",right:"x",top:"y",bottom:"y",center:"x"}[xy]},this._getTL=function(tl){return{left:"left",right:"left",top:"top",bottom:"top",center:"left",x:"left",y:"top"}[tl]},this._getInt=function(value,dimension){return"auto"==value?"auto":value&&"string"==jQuery.type(value)&&"%"==value.slice(-1)?jQuery(window)["height"==dimension?"innerHeight":"innerWidth"]()*parseInt(value.replace("%",""))/100:value},this._createSVG=function(type,options){var svg=document.createElementNS("http://www.w3.org/2000/svg",type);return jQuery.each(options,function(index,item){svg.setAttribute(item[0],item[1]||"")}),svg},this._isolateScroll=function(el){el&&el.length&&el.on("DOMMouseScroll.jBoxIsolateScroll mousewheel.jBoxIsolateScroll",function(ev){var delta=ev.wheelDelta||ev.originalEvent&&ev.originalEvent.wheelDelta||-ev.detail,overflowBottom=0<=this.scrollTop+el.outerHeight()-this.scrollHeight,overflowTop=this.scrollTop<=0;(delta<0&&overflowBottom||0<delta&&overflowTop)&&ev.preventDefault()})},this._setTitleWidth=function(){if(!this.titleContainer||"auto"==this.content[0].style.width&&!this.content[0].style.maxWidth)return null;if("none"==this.wrapper.css("display")){this.wrapper.css("display","block");var contentWidth=this.content.outerWidth();this.wrapper.css("display","none")}else contentWidth=this.content.outerWidth();this.titleContainer.css({maxWidth:Math.max(contentWidth,parseInt(this.content[0].style.maxWidth))||null})},this._draggable=function(){if(!this.options.draggable)return!1;var handle="title"==this.options.draggable?this.titleContainer:this.options.draggable instanceof jQuery?this.options.draggable:"string"==jQuery.type(this.options.draggable)?jQuery(this.options.draggable):this.wrapper;return!(!(handle&&handle instanceof jQuery&&handle.length)||handle.data("jBox-draggable"))&&(handle.addClass("jBox-draggable").data("jBox-draggable",!0).on("touchstart mousedown",function(ev){if(2!=ev.button&&!jQuery(ev.target).hasClass("jBox-noDrag")&&!jQuery(ev.target).parents(".jBox-noDrag").length){this.draggingStartX=ev.pageX,this.draggingStartY=ev.pageY,this.options.dragOver&&!this.trueModal&&parseInt(this.wrapper.css("zIndex"),10)<=jBox.zIndexMaxDragover&&(jBox.zIndexMaxDragover+=1,this.wrapper.css("zIndex",jBox.zIndexMaxDragover));var drg_h=this.wrapper.outerHeight(),drg_w=this.wrapper.outerWidth(),pos_y=this.wrapper.offset().top+drg_h-ev.pageY,pos_x=this.wrapper.offset().left+drg_w-ev.pageX;jQuery(document).on("touchmove.jBox-draggable-"+this.id+" mousemove.jBox-draggable-"+this.id,function(ev){this.dragging||this.draggingStartX==ev.pageX||this.draggingStartY==ev.pageY||(this._fireEvent("onDragStart"),this.dragging=!0),this.wrapper.offset({top:ev.pageY+pos_y-drg_h,left:ev.pageX+pos_x-drg_w})}.bind(this)),ev.preventDefault()}}.bind(this)).on("touchend mouseup",function(){if(jQuery(document).off("touchmove.jBox-draggable-"+this.id+" mousemove.jBox-draggable-"+this.id),this.dragging&&this._fireEvent("onDragEnd"),this.dragging=!1,("Modal"==this.type||"Confirm"==this.type)&&this.options.holdPosition){var jBoxOffset=jQuery("#"+this.id).offset(),pos={x:jBoxOffset.left-jQuery(document).scrollLeft(),y:jBoxOffset.top-jQuery(document).scrollTop()};this.position({position:pos,offset:{x:0,y:0}})}}.bind(this)),this.trueModal||(jBox.zIndexMaxDragover=jBox.zIndexMaxDragover?Math.max(jBox.zIndexMaxDragover,this.options.zIndex):this.options.zIndex),this)},this._create=function(){if(!this.wrapper){if(this.wrapper=jQuery("<div/>",{id:this.id,class:"jBox-wrapper"+(this.type?" jBox-"+this.type:"")+(this.options.theme?" jBox-"+this.options.theme:"")+(this.options.addClass?" "+this.options.addClass:"")}).css({position:this.options.fixed?"fixed":"absolute",display:"none",opacity:0,zIndex:this.options.zIndex}).data("jBox",this),this.options.closeOnMouseleave&&this.wrapper.on("mouseleave",function(ev){!this.source||ev.relatedTarget!=this.source[0]&&-1===jQuery.inArray(this.source[0],jQuery(ev.relatedTarget).parents("*"))&&this.close()}.bind(this)),"box"==this.options.closeOnClick&&this.wrapper.on("click",function(){this.close({ignoreDelay:!0})}.bind(this)),this.container=jQuery('<div class="jBox-container"/>').appendTo(this.wrapper),this.content=jQuery('<div class="jBox-content"/>').appendTo(this.container),this.options.footer&&(this.footer=jQuery('<div class="jBox-footer"/>').append(this.options.footer).appendTo(this.container)),this.options.isolateScroll&&this._isolateScroll(this.content),this.options.closeButton){var closeButtonSVG=this._createSVG("svg",[["viewBox","0 0 24 24"]]);closeButtonSVG.appendChild(this._createSVG("path",[["d","M22.2,4c0,0,0.5,0.6,0,1.1l-6.8,6.8l6.9,6.9c0.5,0.5,0,1.1,0,1.1L20,22.3c0,0-0.6,0.5-1.1,0L12,15.4l-6.9,6.9c-0.5,0.5-1.1,0-1.1,0L1.7,20c0,0-0.5-0.6,0-1.1L8.6,12L1.7,5.1C1.2,4.6,1.7,4,1.7,4L4,1.7c0,0,0.6-0.5,1.1,0L12,8.5l6.8-6.8c0.5-0.5,1.1,0,1.1,0L22.2,4z"]])),this.closeButton=jQuery('<div class="jBox-closeButton jBox-noDrag"/>').on("click",function(ev){this.close({ignoreDelay:!0})}.bind(this)).append(closeButtonSVG),"box"!=this.options.closeButton&&(!0!==this.options.closeButton||this.options.overlay||this.options.title||this.options.getTitle)||(this.wrapper.addClass("jBox-closeButton-box"),this.closeButton.appendTo(this.container))}if(this.wrapper.appendTo(this.options.appendTo),this.wrapper.find(".jBox-closeButton").length&&jQuery.each(["top","right","bottom","left"],function(index,pos){this.wrapper.find(".jBox-closeButton").css(pos)&&"auto"!=this.wrapper.find(".jBox-closeButton").css(pos)&&(this.options.adjustDistance[pos]=Math.max(this.options.adjustDistance[pos],this.options.adjustDistance[pos]+-1*((parseInt(this.wrapper.find(".jBox-closeButton").css(pos))||0)+(parseInt(this.container.css("border-"+pos+"-width"))||0))))}.bind(this)),this.options.pointer){if(this.pointer={position:"target"!=this.options.pointTo?this.options.pointTo:this._getOpp(this.outside),xy:"target"!=this.options.pointTo?this._getXY(this.options.pointTo):this._getXY(this.outside),align:"center",offset:0},this.pointer.element=jQuery('<div class="jBox-pointer jBox-pointer-'+this.pointer.position+'"/>').appendTo(this.wrapper),this.pointer.dimensions={x:this.pointer.element.outerWidth(),y:this.pointer.element.outerHeight()},"string"==jQuery.type(this.options.pointer)){var split=this.options.pointer.split(":");split[0]&&(this.pointer.align=split[0]),split[1]&&(this.pointer.offset=parseInt(split[1]))}this.pointer.alignAttribute="x"==this.pointer.xy?"bottom"==this.pointer.align?"bottom":"top":"right"==this.pointer.align?"right":"left",this.wrapper.css("padding-"+this.pointer.position,this.pointer.dimensions[this.pointer.xy]),this.pointer.element.css(this.pointer.alignAttribute,"center"==this.pointer.align?"50%":0).css("margin-"+this.pointer.alignAttribute,this.pointer.offset),this.pointer.margin={},this.pointer.margin["margin-"+this.pointer.alignAttribute]=this.pointer.offset,"center"==this.pointer.align&&this.pointer.element.css("transform","translate("+("y"==this.pointer.xy?-.5*this.pointer.dimensions.x+"px":0)+", "+("x"==this.pointer.xy?-.5*this.pointer.dimensions.y+"px":0)+")"),this.pointer.element.css("x"==this.pointer.xy?"width":"height",parseInt(this.pointer.dimensions[this.pointer.xy])+parseInt(this.container.css("border-"+this.pointer.alignAttribute+"-width"))),this.wrapper.addClass("jBox-pointerPosition-"+this.pointer.position)}this.setContent(this.options.content,!0),this.setTitle(this.options.title,!0),this.options.draggable&&this._draggable(),this._fireEvent("onCreated")}},this.options.createOnInit&&this._create(),this.options.attach&&this.attach(),this._attachEvents=function(){this.options.delayOnHover&&jQuery("#"+this.id).on("mouseenter",function(ev){this.isHovered=!0}.bind(this)),this.options.delayOnHover&&jQuery("#"+this.id).on("mouseleave",function(ev){this.isHovered=!1}.bind(this)),(this.options.adjustPosition||this.options.reposition)&&!this.fixed&&this.outside&&(this.options.adjustTracker&&jQuery(window).on("scroll.jBox-"+this.id,function(ev){this.position()}.bind(this)),(this.options.adjustPosition||this.options.reposition)&&jQuery(window).on("resize.jBox-"+this.id,function(ev){this.position()}.bind(this))),"mouse"==this.options.target&&jQuery("body").on("mousemove.jBox-"+this.id,function(ev){this.position({mouseTarget:{top:ev.pageY,left:ev.pageX}})}.bind(this))},this._detachEvents=function(){this.options.closeOnEsc&&jQuery(document).off("keyup.jBox-"+this.id),!0!==this.options.closeOnClick&&"body"!=this.options.closeOnClick||jQuery(document).off("click.jBox-"+this.id),this.options.adjustTracker&&jQuery(window).off("scroll.jBox-"+this.id),(this.options.adjustPosition||this.options.reposition)&&jQuery(window).off("resize.jBox-"+this.id),"mouse"==this.options.target&&jQuery("body").off("mousemove.jBox-"+this.id)},this._showOverlay=function(){this.overlay||(this.overlay=jQuery('<div id="'+this.id+'-overlay"/>').addClass("jBox-overlay"+(this.type?" jBox-overlay-"+this.type:"")).css({display:"none",opacity:0,zIndex:this.options.zIndex-1}).appendTo(this.options.appendTo),"overlay"!=this.options.closeButton&&!0!==this.options.closeButton||this.overlay.append(this.closeButton),"overlay"==this.options.closeOnClick&&this.overlay.on("click",function(){this.close({ignoreDelay:!0})}.bind(this)),jQuery("#"+this.id+"-overlay .jBox-closeButton").length&&(this.options.adjustDistance.top=Math.max(jQuery("#"+this.id+"-overlay .jBox-closeButton").outerHeight(),this.options.adjustDistance.top))),!0===this.adjustZIndexOnOpen&&this.overlay.css("zIndex",parseInt(this.wrapper.css("zIndex"),10)-1),"block"!=this.overlay.css("display")&&(this.options.fade?this.overlay.stop()&&this.overlay.animate({opacity:1},{queue:!1,duration:this.options.fade,start:function(){this.overlay.css({display:"block"})}.bind(this)}):this.overlay.css({display:"block",opacity:1}))},this._hideOverlay=function(){this.overlay&&(this.options.fade?this.overlay.stop()&&this.overlay.animate({opacity:0},{queue:!1,duration:this.options.fade,complete:function(){this.overlay.css({display:"none"})}.bind(this)}):this.overlay.css({display:"none",opacity:0}))},this._exposeDimensions=function(){this.wrapper.css({top:-1e4,left:-1e4,right:"auto",bottom:"auto"});var jBoxDimensions={x:this.wrapper.outerWidth(),y:this.wrapper.outerHeight()};return this.wrapper.css({top:"auto",left:"auto"}),jBoxDimensions},this._generateAnimationCSS=function(){if("object"!=jQuery.type(this.options.animation)&&(this.options.animation={pulse:{open:"pulse",close:"zoomOut"},zoomIn:{open:"zoomIn",close:"zoomIn"},zoomOut:{open:"zoomOut",close:"zoomOut"},move:{open:"move",close:"move"},slide:{open:"slide",close:"slide"},flip:{open:"flip",close:"flip"},tada:{open:"tada",close:"zoomOut"}}[this.options.animation]),!this.options.animation)return null;this.options.animation.open&&(this.options.animation.open=this.options.animation.open.split(":")),this.options.animation.close&&(this.options.animation.close=this.options.animation.close.split(":")),this.options.animation.openDirection=this.options.animation.open[1]?this.options.animation.open[1]:null,this.options.animation.closeDirection=this.options.animation.close[1]?this.options.animation.close[1]:null,this.options.animation.open&&(this.options.animation.open=this.options.animation.open[0]),this.options.animation.close&&(this.options.animation.close=this.options.animation.close[0]),this.options.animation.open&&(this.options.animation.open+="Open"),this.options.animation.close&&(this.options.animation.close+="Close");var animations={pulse:{duration:350,css:[["0%","scale(1)"],["50%","scale(1.1)"],["100%","scale(1)"]]},zoomInOpen:{duration:this.options.fade||180,css:[["0%","scale(0.9)"],["100%","scale(1)"]]},zoomInClose:{duration:this.options.fade||180,css:[["0%","scale(1)"],["100%","scale(0.9)"]]},zoomOutOpen:{duration:this.options.fade||180,css:[["0%","scale(1.1)"],["100%","scale(1)"]]},zoomOutClose:{duration:this.options.fade||180,css:[["0%","scale(1)"],["100%","scale(1.1)"]]},moveOpen:{duration:this.options.fade||180,positions:{top:{"0%":-12},right:{"0%":12},bottom:{"0%":12},left:{"0%":-12}},css:[["0%","translate%XY(%Vpx)"],["100%","translate%XY(0px)"]]},moveClose:{duration:this.options.fade||180,timing:"ease-in",positions:{top:{"100%":-12},right:{"100%":12},bottom:{"100%":12},left:{"100%":-12}},css:[["0%","translate%XY(0px)"],["100%","translate%XY(%Vpx)"]]},slideOpen:{duration:400,positions:{top:{"0%":-400},right:{"0%":400},bottom:{"0%":400},left:{"0%":-400}},css:[["0%","translate%XY(%Vpx)"],["100%","translate%XY(0px)"]]},slideClose:{duration:400,timing:"ease-in",positions:{top:{"100%":-400},right:{"100%":400},bottom:{"100%":400},left:{"100%":-400}},css:[["0%","translate%XY(0px)"],["100%","translate%XY(%Vpx)"]]},flipOpen:{duration:600,css:[["0%","perspective(400px) rotateX(90deg)"],["40%","perspective(400px) rotateX(-15deg)"],["70%","perspective(400px) rotateX(15deg)"],["100%","perspective(400px) rotateX(0deg)"]]},flipClose:{duration:this.options.fade||300,css:[["0%","perspective(400px) rotateX(0deg)"],["100%","perspective(400px) rotateX(90deg)"]]},tada:{duration:800,css:[["0%","scale(1)"],["10%, 20%","scale(0.9) rotate(-3deg)"],["30%, 50%, 70%, 90%","scale(1.1) rotate(3deg)"],["40%, 60%, 80%","scale(1.1) rotate(-3deg)"],["100%","scale(1) rotate(0)"]]}};jQuery.each(["pulse","tada"],function(index,item){animations[item+"Open"]=animations[item+"Close"]=animations[item]});var generateKeyframeCSS=function(ev,position){return keyframe_css="@keyframes jBox-"+this.id+"-animation-"+this.options.animation[ev]+"-"+ev+(position?"-"+position:"")+" {",jQuery.each(animations[this.options.animation[ev]].css,function(index,item){var translate=position?item[1].replace("%XY",this._getXY(position).toUpperCase()):item[1];animations[this.options.animation[ev]].positions&&(translate=translate.replace("%V",animations[this.options.animation[ev]].positions[position][item[0]])),keyframe_css+=item[0]+" {transform:"+translate+";}"}.bind(this)),keyframe_css+="}",keyframe_css+=".jBox-"+this.id+"-animation-"+this.options.animation[ev]+"-"+ev+(position?"-"+position:"")+" {",keyframe_css+="animation-duration: "+animations[this.options.animation[ev]].duration+"ms;",keyframe_css+="animation-name: jBox-"+this.id+"-animation-"+this.options.animation[ev]+"-"+ev+(position?"-"+position:"")+";",keyframe_css+=animations[this.options.animation[ev]].timing?"animation-timing-function: "+animations[this.options.animation[ev]].timing+";":"",keyframe_css+="}",keyframe_css}.bind(this);this._animationCSS="",jQuery.each(["open","close"],function(index,ev){if(!this.options.animation[ev]||!animations[this.options.animation[ev]]||"close"==ev&&!this.options.fade)return"";animations[this.options.animation[ev]].positions?jQuery.each(["top","right","bottom","left"],function(index2,position){this._animationCSS+=generateKeyframeCSS(ev,position)}.bind(this)):this._animationCSS+=generateKeyframeCSS(ev)}.bind(this))},this.options.animation&&this._generateAnimationCSS(),this._blockBodyClick=function(){this.blockBodyClick=!0,setTimeout(function(){this.blockBodyClick=!1}.bind(this),10)},this._animate=function(ev){if(ev||(ev=this.isOpen?"open":"close"),!this.options.fade&&"close"==ev)return null;var animationDirection=this.options.animation[ev+"Direction"]||("center"!=this.align?this.align:this.options.attributes.x);this.flipped&&this._getXY(animationDirection)==this._getXY(this.align)&&(animationDirection=this._getOpp(animationDirection));var classnames="jBox-"+this.id+"-animation-"+this.options.animation[ev]+"-"+ev+" jBox-"+this.id+"-animation-"+this.options.animation[ev]+"-"+ev+"-"+animationDirection;this.wrapper.addClass(classnames);var animationDuration=1e3*parseFloat(this.wrapper.css("animation-duration"));"close"==ev&&(animationDuration=Math.min(animationDuration,this.options.fade)),setTimeout(function(){this.wrapper.removeClass(classnames)}.bind(this),animationDuration)},this._abortAnimation=function(){var classes=this.wrapper.attr("class").split(" ").filter(function(c){return 0!==c.lastIndexOf("jBox-"+this.id+"-animation",0)}.bind(this));this.wrapper.attr("class",classes.join(" "))},(this.options.responsiveWidth||this.options.responsiveHeight)&&jQuery(window).on("resize.responsivejBox-"+this.id,function(ev){this.isOpen&&this.position()}.bind(this)),"string"===jQuery.type(this.options.preloadAudio)&&(this.options.preloadAudio=[this.options.preloadAudio]),"string"===jQuery.type(this.options.audio)&&(this.options.audio={open:this.options.audio}),"number"===jQuery.type(this.options.volume)&&(this.options.volume={open:this.options.volume,close:this.options.volume}),!0===this.options.preloadAudio&&this.options.audio&&(this.options.preloadAudio=[],jQuery.each(this.options.audio,function(index,url){this.options.preloadAudio.push(url+".mp3"),this.options.preloadAudio.push(url+".ogg")}.bind(this))),this.options.preloadAudio.length&&jQuery.each(this.options.preloadAudio,function(index,url){var audio=new Audio;audio.src=url,audio.preload="auto"}),this._fireEvent("onInit"),this}var i;return jBox.prototype.attach=function(elements,trigger){return elements||(elements=this.options.attach),"string"==jQuery.type(elements)&&(elements=jQuery(elements)),trigger||(trigger=this.options.trigger),elements&&elements.length&&jQuery.each(elements,function(index,el){(el=jQuery(el)).data("jBox-attached-"+this.id)||("title"==this.options.getContent&&null!=el.attr("title")&&el.data("jBox-getContent",el.attr("title")).removeAttr("title"),this.attachedElements||(this.attachedElements=[]),this.attachedElements.push(el[0]),el.on(trigger+".jBox-attach-"+this.id,function(ev){if(this.timer&&clearTimeout(this.timer),"mouseenter"!=trigger||!this.isOpen||this.source[0]!=el[0]){if(this.isOpen&&this.source&&this.source[0]!=el[0])var forceOpen=!0;this.source=el,this.options.target||(this.target=el),"click"==trigger&&this.options.preventDefault&&ev.preventDefault(),this["click"!=trigger||forceOpen?"open":"toggle"]()}}.bind(this)),"mouseenter"==this.options.trigger&&el.on("mouseleave",function(ev){if(!this.wrapper)return null;this.options.closeOnMouseleave&&(ev.relatedTarget==this.wrapper[0]||jQuery(ev.relatedTarget).parents("#"+this.id).length)||this.close()}.bind(this)),el.data("jBox-attached-"+this.id,trigger),this._fireEvent("onAttach",el))}.bind(this)),this},jBox.prototype.detach=function(elements){return elements||(elements=this.attachedElements||[]),elements&&elements.length&&jQuery.each(elements,function(index,el){(el=jQuery(el)).data("jBox-attached-"+this.id)&&(el.off(el.data("jBox-attached-"+this.id)+".jBox-attach-"+this.id),el.data("jBox-attached-"+this.id,null)),this.attachedElements=jQuery.grep(this.attachedElements,function(value){return value!=el[0]})}.bind(this)),this},jBox.prototype.setTitle=function(title,ignore_positioning){if(null==title||null==title)return this;this.wrapper||this._create();var wrapperHeight=this.wrapper.outerHeight(),wrapperWidth=this.wrapper.outerWidth();return this.title||(this.titleContainer=jQuery('<div class="jBox-title"/>'),this.title=jQuery("<div/>").appendTo(this.titleContainer),this.wrapper.addClass("jBox-hasTitle"),"title"!=this.options.closeButton&&(!0!==this.options.closeButton||this.options.overlay)||(this.wrapper.addClass("jBox-closeButton-title"),this.closeButton.appendTo(this.titleContainer)),this.titleContainer.insertBefore(this.content),this._setTitleWidth()),this.title.html(title),wrapperWidth!=this.wrapper.outerWidth()&&this._setTitleWidth(),this.options.draggable&&this._draggable(),ignore_positioning||!this.options.repositionOnContent||wrapperHeight==this.wrapper.outerHeight()&&wrapperWidth==this.wrapper.outerWidth()||this.position(),this},jBox.prototype.setContent=function(content,ignore_positioning){if(null==content||null==content)return this;this.wrapper||this._create();var wrapperHeight=this.wrapper.outerHeight(),wrapperWidth=this.wrapper.outerWidth();switch(this.content.children("[data-jbox-content-appended]").appendTo("body").css({display:"none"}),jQuery.type(content)){case"string":this.content.html(content);break;case"object":this.content.html(""),content.attr("data-jbox-content-appended",1).appendTo(this.content).css({display:"block"})}return wrapperWidth!=this.wrapper.outerWidth()&&this._setTitleWidth(),this.options.draggable&&this._draggable(),ignore_positioning||!this.options.repositionOnContent||wrapperHeight==this.wrapper.outerHeight()&&wrapperWidth==this.wrapper.outerWidth()||this.position(),this},jBox.prototype.setDimensions=function(type,value,pos){this.wrapper||this._create(),null==value&&(value="auto"),this.content.css(type,this._getInt(value)),"width"==type&&this._setTitleWidth(),null!=pos&&!pos||this.position()},jBox.prototype.setWidth=function(value,pos){this.setDimensions("width",value,pos)},jBox.prototype.setHeight=function(value,pos){this.setDimensions("height",value,pos)},jBox.prototype.position=function(options){if(options||(options={}),options=jQuery.extend(!0,this.options,options),this.target=options.target||this.target||jQuery(window),this.target instanceof jQuery||"mouse"==this.target||(this.target=jQuery(this.target)),!this.target.length)return this;this.content.css({width:this._getInt(options.width,"width"),height:this._getInt(options.height,"height"),minWidth:this._getInt(options.minWidth,"width"),minHeight:this._getInt(options.minHeight,"height"),maxWidth:this._getInt(options.maxWidth,"width"),maxHeight:this._getInt(options.maxHeight,"height")}),this._setTitleWidth();var jBoxDimensions=this._exposeDimensions();"mouse"==this.target||this.target.data("jBox-"+this.id+"-fixed")||this.target.data("jBox-"+this.id+"-fixed",this.target[0]!=jQuery(window)[0]&&("fixed"==this.target.css("position")||0<this.target.parents().filter(function(){return"fixed"==jQuery(this).css("position")}).length)?"fixed":"static");var windowDimensions={x:jQuery(window).outerWidth(),y:jQuery(window).outerHeight(),top:options.fixed&&this.target.data("jBox-"+this.id+"-fixed")?0:jQuery(window).scrollTop(),left:options.fixed&&this.target.data("jBox-"+this.id+"-fixed")?0:jQuery(window).scrollLeft()};windowDimensions.bottom=windowDimensions.top+windowDimensions.y,windowDimensions.right=windowDimensions.left+windowDimensions.x;try{var targetOffset=this.target.offset()}catch(e){targetOffset={top:0,left:0}}"mouse"!=this.target&&"fixed"==this.target.data("jBox-"+this.id+"-fixed")&&options.fixed&&(targetOffset.top=targetOffset.top-jQuery(window).scrollTop(),targetOffset.left=targetOffset.left-jQuery(window).scrollLeft());var targetDimensions={x:"mouse"==this.target?12:this.target.outerWidth(),y:"mouse"==this.target?20:this.target.outerHeight(),top:"mouse"==this.target&&options.mouseTarget?options.mouseTarget.top:targetOffset?targetOffset.top:0,left:"mouse"==this.target&&options.mouseTarget?options.mouseTarget.left:targetOffset?targetOffset.left:0},outside=options.outside&&!("center"==options.position.x&&"center"==options.position.y),availableSpace={x:windowDimensions.x-options.adjustDistance.left-options.adjustDistance.right,y:windowDimensions.y-options.adjustDistance.top-options.adjustDistance.bottom,left:outside?targetDimensions.left-jQuery(window).scrollLeft()-options.adjustDistance.left:0,right:outside?windowDimensions.x-targetDimensions.left+jQuery(window).scrollLeft()-targetDimensions.x-options.adjustDistance.right:0,top:outside?targetDimensions.top-jQuery(window).scrollTop()-this.options.adjustDistance.top:0,bottom:outside?windowDimensions.y-targetDimensions.top+jQuery(window).scrollTop()-targetDimensions.y-options.adjustDistance.bottom:0},jBoxOutsidePosition={x:"x"!=options.outside&&"xy"!=options.outside||"number"==jQuery.type(options.position.x)?null:options.position.x,y:"y"!=options.outside&&"xy"!=options.outside||"number"==jQuery.type(options.position.y)?null:options.position.y},flip={x:!1,y:!1};if(jBoxOutsidePosition.x&&jBoxDimensions.x>availableSpace[jBoxOutsidePosition.x]&&availableSpace[this._getOpp(jBoxOutsidePosition.x)]>availableSpace[jBoxOutsidePosition.x]&&(jBoxOutsidePosition.x=this._getOpp(jBoxOutsidePosition.x))&&(flip.x=!0),jBoxOutsidePosition.y&&jBoxDimensions.y>availableSpace[jBoxOutsidePosition.y]&&availableSpace[this._getOpp(jBoxOutsidePosition.y)]>availableSpace[jBoxOutsidePosition.y]&&(jBoxOutsidePosition.y=this._getOpp(jBoxOutsidePosition.y))&&(flip.y=!0),options.responsiveWidth||options.responsiveHeight){var adjustResponsiveWidth=function(){if(options.responsiveWidth&&jBoxDimensions.x>availableSpace[jBoxOutsidePosition.x||"x"]){var contentWidth=availableSpace[jBoxOutsidePosition.x||"x"]-(this.pointer&&outside&&"x"==options.outside?this.pointer.dimensions.x:0)-parseInt(this.container.css("border-left-width"))-parseInt(this.container.css("border-right-width"));this.content.css({width:contentWidth>this.options.responsiveMinWidth?contentWidth:null,minWidth:contentWidth<parseInt(this.content.css("minWidth"))?0:null}),this._setTitleWidth()}jBoxDimensions=this._exposeDimensions()}.bind(this);options.responsiveWidth&&adjustResponsiveWidth(),options.responsiveWidth&&!flip.y&&jBoxOutsidePosition.y&&jBoxDimensions.y>availableSpace[jBoxOutsidePosition.y]&&availableSpace[this._getOpp(jBoxOutsidePosition.y)]>availableSpace[jBoxOutsidePosition.y]&&(jBoxOutsidePosition.y=this._getOpp(jBoxOutsidePosition.y))&&(flip.y=!0);var adjustResponsiveHeight=function(){if(options.responsiveHeight&&jBoxDimensions.y>availableSpace[jBoxOutsidePosition.y||"y"]){var exposeTitleFooterHeight=function(){if(!this.titleContainer&&!this.footer)return 0;if("none"==this.wrapper.css("display")){this.wrapper.css("display","block");var height=(this.titleContainer?this.titleContainer.outerHeight():0)+(this.footer?this.footer.outerHeight():0);this.wrapper.css("display","none")}else height=(this.titleContainer?this.titleContainer.outerHeight():0)+(this.footer?this.footer.outerHeight():0);return height||0}.bind(this),contentHeight=availableSpace[jBoxOutsidePosition.y||"y"]-(this.pointer&&outside&&"y"==options.outside?this.pointer.dimensions.y:0)-exposeTitleFooterHeight()-parseInt(this.container.css("border-top-width"))-parseInt(this.container.css("border-bottom-width"));this.content.css({height:contentHeight>this.options.responsiveMinHeight?contentHeight:null}),this._setTitleWidth()}jBoxDimensions=this._exposeDimensions()}.bind(this);options.responsiveHeight&&adjustResponsiveHeight(),options.responsiveHeight&&!flip.x&&jBoxOutsidePosition.x&&jBoxDimensions.x>availableSpace[jBoxOutsidePosition.x]&&availableSpace[this._getOpp(jBoxOutsidePosition.x)]>availableSpace[jBoxOutsidePosition.x]&&(jBoxOutsidePosition.x=this._getOpp(jBoxOutsidePosition.x))&&(flip.x=!0),options.adjustPosition&&"move"!=options.adjustPosition&&(flip.x&&adjustResponsiveWidth(),flip.y&&adjustResponsiveHeight())}var pos={},setPosition=function(p){if("number"!=jQuery.type(options.position[p])){var a=options.attributes[p]="x"==p?"left":"top";if(pos[a]=targetDimensions[a],"center"==options.position[p])return pos[a]+=Math.ceil((targetDimensions[p]-jBoxDimensions[p])/2),void("mouse"!=this.target&&this.target[0]&&this.target[0]==jQuery(window)[0]&&(pos[a]+=.5*(options.adjustDistance[a]-options.adjustDistance[this._getOpp(a)])));a!=options.position[p]&&(pos[a]+=targetDimensions[p]-jBoxDimensions[p]),options.outside!=p&&"xy"!=options.outside||(pos[a]+=jBoxDimensions[p]*(a!=options.position[p]?1:-1))}else pos[options.attributes[p]]=options.position[p]}.bind(this);if(setPosition("x"),setPosition("y"),this.pointer&&"target"==options.pointTo&&"number"!=jQuery.type(options.position.x)&&"number"!=jQuery.type(options.position.y)){var adjustWrapper=0;switch(this.pointer.align){case"center":"center"!=options.position[this._getOpp(options.outside)]&&(adjustWrapper+=jBoxDimensions[this._getOpp(options.outside)]/2);break;default:switch(options.position[this._getOpp(options.outside)]){case"center":adjustWrapper+=(jBoxDimensions[this._getOpp(options.outside)]/2-this.pointer.dimensions[this._getOpp(options.outside)]/2)*(this.pointer.align==this._getTL(this.pointer.align)?1:-1);break;default:adjustWrapper+=this.pointer.align!=options.position[this._getOpp(options.outside)]?this.dimensions[this._getOpp(options.outside)]*(-1!==jQuery.inArray(this.pointer.align,["top","left"])?1:-1)+this.pointer.dimensions[this._getOpp(options.outside)]/2*(-1!==jQuery.inArray(this.pointer.align,["top","left"])?-1:1):this.pointer.dimensions[this._getOpp(options.outside)]/2*(-1!==jQuery.inArray(this.pointer.align,["top","left"])?1:-1)}}adjustWrapper*=options.position[this._getOpp(options.outside)]==this.pointer.alignAttribute?-1:1,adjustWrapper+=this.pointer.offset*(this.pointer.align==this._getOpp(this._getTL(this.pointer.align))?1:-1),pos[this._getTL(this._getOpp(this.pointer.xy))]+=adjustWrapper}if(pos[options.attributes.x]+=options.offset.x,pos[options.attributes.y]+=options.offset.y,this.wrapper.css(pos),options.adjustPosition){this.positionAdjusted&&(this.pointer&&this.wrapper.css("padding",0).css("padding-"+this._getOpp(this.outside),this.pointer.dimensions[this._getXY(this.outside)]).removeClass("jBox-pointerPosition-"+this._getOpp(this.pointer.position)).addClass("jBox-pointerPosition-"+this.pointer.position),this.pointer&&this.pointer.element.attr("class","jBox-pointer jBox-pointer-"+this._getOpp(this.outside)).css(this.pointer.margin),this.positionAdjusted=!1,this.flipped=!1);var outYT=windowDimensions.top>pos.top-(options.adjustDistance.top||0),outXR=windowDimensions.right<pos.left+jBoxDimensions.x+(options.adjustDistance.right||0),outYB=windowDimensions.bottom<pos.top+jBoxDimensions.y+(options.adjustDistance.bottom||0),outXL=windowDimensions.left>pos.left-(options.adjustDistance.left||0),outX=outXL?"left":outXR?"right":null,outY=outYT?"top":outYB?"bottom":null;if(outX||outY){if(("Modal"==this.type||"Confirm"==this.type)&&"number"==jQuery.type(this.options.position.x)&&"number"==jQuery.type(this.options.position.y)){var diffX=0,diffY=0;return this.options.holdPosition&&(outXL?diffX=windowDimensions.left-(pos.left-(options.adjustDistance.left||0)):outXR&&(diffX=windowDimensions.right-(pos.left+jBoxDimensions.x+(options.adjustDistance.right||0))),outYT?diffY=windowDimensions.top-(pos.top-(options.adjustDistance.top||0)):outYB&&(diffY=windowDimensions.bottom-(pos.top+jBoxDimensions.y+(options.adjustDistance.bottom||0))),this.options.position.x=Math.max(windowDimensions.top,this.options.position.x+diffX),this.options.position.y=Math.max(windowDimensions.left,this.options.position.y+diffY),setPosition("x"),setPosition("y"),this.wrapper.css(pos)),this._fireEvent("onPosition"),this}if(!0===options.adjustPosition||"flip"===options.adjustPosition){var flipJBox=function(xy){this.wrapper.css(this._getTL(xy),pos[this._getTL(xy)]+(jBoxDimensions[this._getXY(xy)]+options.offset[this._getXY(xy)]*("top"==xy||"left"==xy?-2:2)+targetDimensions[this._getXY(xy)])*("top"==xy||"left"==xy?1:-1)),this.pointer&&this.wrapper.removeClass("jBox-pointerPosition-"+this.pointer.position).addClass("jBox-pointerPosition-"+this._getOpp(this.pointer.position)).css("padding",0).css("padding-"+xy,this.pointer.dimensions[this._getXY(xy)]),this.pointer&&this.pointer.element.attr("class","jBox-pointer jBox-pointer-"+xy),this.positionAdjusted=!0,this.flipped=!0}.bind(this);flip.x&&flipJBox(this.options.position.x),flip.y&&flipJBox(this.options.position.y)}var outMove="x"==this._getXY(this.outside)?outY:outX;if(this.pointer&&"target"==options.pointTo&&"flip"!=options.adjustPosition&&this._getXY(outMove)==this._getOpp(this._getXY(this.outside))){if("center"==this.pointer.align)var spaceAvail=jBoxDimensions[this._getXY(outMove)]/2-this.pointer.dimensions[this._getOpp(this.pointer.xy)]/2-parseInt(this.pointer.element.css("margin-"+this.pointer.alignAttribute))*(outMove!=this._getTL(outMove)?-1:1);else spaceAvail=outMove==this.pointer.alignAttribute?parseInt(this.pointer.element.css("margin-"+this.pointer.alignAttribute)):jBoxDimensions[this._getXY(outMove)]-parseInt(this.pointer.element.css("margin-"+this.pointer.alignAttribute))-this.pointer.dimensions[this._getXY(outMove)];var spaceDiff=outMove==this._getTL(outMove)?windowDimensions[this._getTL(outMove)]-pos[this._getTL(outMove)]+options.adjustDistance[outMove]:-1*(windowDimensions[this._getOpp(this._getTL(outMove))]-pos[this._getTL(outMove)]-options.adjustDistance[outMove]-jBoxDimensions[this._getXY(outMove)]);outMove==this._getOpp(this._getTL(outMove))&&pos[this._getTL(outMove)]-spaceDiff<windowDimensions[this._getTL(outMove)]+options.adjustDistance[this._getTL(outMove)]&&(spaceDiff-=windowDimensions[this._getTL(outMove)]+options.adjustDistance[this._getTL(outMove)]-(this.pos[this._getTL(outMove)]-spaceDiff)),(spaceDiff=Math.min(spaceDiff,spaceAvail))<=spaceAvail&&0<spaceDiff&&(this.pointer.element.css("margin-"+this.pointer.alignAttribute,parseInt(this.pointer.element.css("margin-"+this.pointer.alignAttribute))-spaceDiff*(outMove!=this.pointer.alignAttribute?-1:1)),this.wrapper.css(this._getTL(outMove),pos[this._getTL(outMove)]+spaceDiff*(outMove!=this._getTL(outMove)?-1:1)),this.positionAdjusted=!0)}}}return this._fireEvent("onPosition"),this},jBox.prototype.open=function(options){if(options||(options={}),this.isDestroyed)return this;if(this.wrapper||this._create(),this._styles||(this._styles=jQuery("<style/>").append(this._animationCSS).appendTo(jQuery("head"))),this.timer&&clearTimeout(this.timer),this._blockBodyClick(),this.isDisabled)return this;this.options.closeOnEsc&&jQuery(document).on("keyup.jBox-"+this.id,function(ev){27==ev.keyCode&&this.close({ignoreDelay:!0})}.bind(this)),!0!==this.options.closeOnClick&&"body"!==this.options.closeOnClick||(jQuery("body").on("click.jBox-"+this.id,function(ev){this.blockBodyClick||"body"==this.options.closeOnClick&&(ev.target==this.wrapper[0]||this.wrapper.has(ev.target).length)||this.close({ignoreDelay:!0})}.bind(this)),this.isTouchDevice&&jQuery("body > *").on("click.jBox-"+this.id,function(){return!0}));var open=function(){!0===this.adjustZIndexOnOpen&&(jBox.zIndexMax=Math.max(parseInt(this.wrapper.css("zIndex"),10),this.options.zIndex,jBox.zIndexMax||0,jBox.zIndexMaxDragover||0)+2,this.wrapper.css("zIndex",jBox.zIndexMax),this.options.zIndex=jBox.zIndexMax),this.source&&this.options.getTitle&&this.source.attr(this.options.getTitle)&&this.setTitle(this.source.attr(this.options.getTitle),!0),this.source&&this.options.getContent&&(this.source.data("jBox-getContent")?this.setContent(this.source.data("jBox-getContent"),!0):this.source.attr(this.options.getContent)?this.setContent(this.source.attr(this.options.getContent),!0):"html"==this.options.getContent&&this.setContent(this.source.html(),!0)),this._fireEvent("onOpen"),(this.options.ajax&&(this.options.ajax.url||this.source&&this.source.attr(this.options.ajax.getURL))&&(!this.ajaxLoaded||this.options.ajax.reload)||options.ajax&&(options.ajax.url||options.ajax.data))&&("strict"==this.options.ajax.reload||!this.source||!this.source.data("jBox-ajax-data")||options.ajax&&(options.ajax.url||options.ajax.data)?this.ajax(options.ajax||null,!0):this.setContent(this.source.data("jBox-ajax-data"))),this.positionedOnOpen&&!this.options.repositionOnOpen||!this.position(options)||(this.positionedOnOpen=!0),this.isClosing&&this._abortAnimation(),this.isOpen||(this.isOpen=!0,this.options.autoClose&&(this.options.delayClose=this.options.autoClose)&&this.close(),this._attachEvents(),this.options.blockScroll&&(this.options.blockScrollAdjust?jBox.blockScrollScopes?jBox.blockScrollScopes++:(jBox.blockScrollScopes=1,unscroll(Array.isArray(this.options.blockScrollAdjust)||"string"==typeof this.options.blockScrollAdjust?this.options.blockScrollAdjust:null)):jQuery("body").addClass("jBox-blockScroll-"+this.id)),this.options.overlay&&(this._showOverlay(),this.position()),this.options.animation&&!this.isClosing&&this._animate("open"),this.options.audio&&this.options.audio.open&&this.audio(this.options.audio.open,this.options.volume.open),this.options.fade?this.wrapper.stop().animate({opacity:1},{queue:!1,duration:this.options.fade,start:function(){this.isOpening=!0,this.wrapper.css({display:"block"})}.bind(this),always:function(){this.isOpening=!1,setTimeout(function(){this.positionOnFadeComplete&&this.position()&&(this.positionOnFadeComplete=!1)}.bind(this),10)}.bind(this)}):(this.wrapper.css({display:"block",opacity:1}),this.positionOnFadeComplete&&this.position()&&(this.positionOnFadeComplete=!1)))}.bind(this);return!this.options.delayOpen||this.isOpen||this.isClosing||options.ignoreDelay?open():this.timer=setTimeout(open,this.options.delayOpen),this},jBox.prototype.close=function(options){if(options||(options={}),jQuery("body").off("click.jBox-"+this.id),this.isTouchDevice&&jQuery("body > *").off("click.jBox-"+this.id),this.isDestroyed||this.isClosing)return this;if(this.timer&&clearTimeout(this.timer),this._blockBodyClick(),this.isDisabled)return this;var close=function(){if(this._fireEvent("onClose"),this.options.cancelAjaxOnClose&&this.cancelAjax(),this.isOpen){this.isOpen=!1,this._detachEvents(),this.options.blockScroll&&(this.options.blockScrollAdjust?(jBox.blockScrollScopes=jBox.blockScrollScopes?--jBox.blockScrollScopes:0)||unscroll.reset():jQuery("body").removeClass("jBox-blockScroll-"+this.id)),this.options.overlay&&this._hideOverlay(),this.options.animation&&!this.isOpening&&this._animate("close"),this.options.audio&&this.options.audio.close&&this.audio(this.options.audio.close,this.options.volume.close);var fadeDuration=this.isTouchDevice&&"mouse"==this.options.target?0:this.options.fade;fadeDuration?this.wrapper.stop().animate({opacity:0},{queue:!1,duration:fadeDuration,start:function(){this.isClosing=!0}.bind(this),complete:function(){this.wrapper.css({display:"none"}),this._fireEvent("onCloseComplete")}.bind(this),always:function(){this.isClosing=!1}.bind(this)}):(this.wrapper.css({display:"none",opacity:0}),this._fireEvent("onCloseComplete"))}}.bind(this);if(options.ignoreDelay||this.isTouchDevice&&"mouse"==this.options.target)close();else if((this.options.delayOnHover||this.options.showCountdown)&&10<this.options.delayClose){var self=this,remaining=this.options.delayClose,prevFrame=Date.now();if(this.options.showCountdown&&!this.inner){var outer=jQuery('<div class="jBox-countdown"></div>');this.inner=jQuery('<div class="jBox-countdown_inner"></div>'),outer.prepend(this.inner),jQuery("#"+this.id).append(outer)}this.countdown=function(){var dateNow=Date.now();self.isHovered||(remaining-=dateNow-prevFrame),prevFrame=dateNow,0<remaining?(self.options.showCountdown&&self.inner.css("width",100*remaining/self.options.delayClose+"%"),window.requestAnimationFrame(self.countdown)):close()},window.requestAnimationFrame(this.countdown)}else this.timer=setTimeout(close,Math.max(this.options.delayClose,10));return this},jBox.prototype.toggle=function(options){return this[this.isOpen?"close":"open"](options),this},jBox.prototype.disable=function(){return this.isDisabled=!0,this},jBox.prototype.enable=function(){return this.isDisabled=!1,this},jBox.prototype.hide=function(){return this.disable(),this.wrapper&&this.wrapper.css({display:"none"}),this},jBox.prototype.show=function(){return this.enable(),this.wrapper&&this.wrapper.css({display:"block"}),this},jBox.prototype.ajax=function(options,opening){options||(options={}),jQuery.each([["getData","data"],["getURL","url"]],function(index,item){this.options.ajax[item[0]]&&!options[item[1]]&&this.source&&null!=this.source.attr(this.options.ajax[item[0]])&&(options[item[1]]=this.source.attr(this.options.ajax[item[0]])||"")}.bind(this));var sysOptions=jQuery.extend(!0,{},this.options.ajax);this.cancelAjax();var beforeSend=options.beforeSend||sysOptions.beforeSend||function(){},complete=options.complete||sysOptions.complete||function(){},success=options.success||sysOptions.success||function(){},error=options.error||sysOptions.error||function(){},userOptions=jQuery.extend(!0,sysOptions,options);return userOptions.beforeSend=function(xhr){userOptions.loadingClass&&this.wrapper.addClass(!0===userOptions.loadingClass?"jBox-loading":userOptions.loadingClass),userOptions.spinner&&(this.spinnerDelay=setTimeout(function(){this.wrapper.addClass("jBox-loading-spinner"),userOptions.spinnerReposition&&(opening?this.positionOnFadeComplete=!0:this.position()),this.spinner=jQuery(!0!==userOptions.spinner?userOptions.spinner:'<div class="jBox-spinner"></div>').appendTo(this.container),this.titleContainer&&"absolute"==this.spinner.css("position")&&this.spinner.css({transform:"translateY("+.5*this.titleContainer.outerHeight()+"px)"})}.bind(this),""==this.content.html()?0:userOptions.spinnerDelay||0)),beforeSend.bind(this)(xhr)}.bind(this),userOptions.complete=function(response){this.spinnerDelay&&clearTimeout(this.spinnerDelay),this.wrapper.removeClass("jBox-loading jBox-loading-spinner jBox-loading-spinner-delay"),this.spinner&&this.spinner.length&&this.spinner.remove()&&userOptions.spinnerReposition&&(opening?this.positionOnFadeComplete=!0:this.position()),this.ajaxLoaded=!0,complete.bind(this)(response)}.bind(this),userOptions.success=function(response){userOptions.setContent&&this.setContent(response,!0)&&(opening?this.positionOnFadeComplete=!0:this.position()),userOptions.setContent&&this.source&&this.source.data("jBox-ajax-data",response),success.bind(this)(response)}.bind(this),userOptions.error=function(response){error.bind(this)(response)}.bind(this),this.ajaxRequest=jQuery.ajax(userOptions),this},jBox.prototype.cancelAjax=function(){this.ajaxRequest&&this.ajaxRequest.abort()},jBox.prototype.audio=function(url,volume){if(!url)return this;if(jBox._audio||(jBox._audio={}),!jBox._audio[url]){var audio=jQuery("<audio/>");jQuery("<source/>",{src:url+".mp3"}).appendTo(audio),jQuery("<source/>",{src:url+".ogg"}).appendTo(audio),jBox._audio[url]=audio[0]}jBox._audio[url].volume=Math.min((null!=volume?volume:100)/100,1);try{jBox._audio[url].pause(),jBox._audio[url].currentTime=0}catch(e){}return jBox._audio[url].play(),this},jBox._animationSpeeds={tada:1e3,tadaSmall:1e3,flash:500,shake:400,pulseUp:250,pulseDown:250,popIn:250,popOut:250,fadeIn:200,fadeOut:200,slideUp:400,slideRight:400,slideLeft:400,slideDown:400},jBox.prototype.animate=function(animation,options){options||(options={}),this.animationTimeout||(this.animationTimeout={}),options.element||(options.element=this.wrapper),options.element.data("jBox-animating-id")||options.element.data("jBox-animating-id",jBox._getUniqueElementID()),options.element.data("jBox-animating")&&(options.element.removeClass(options.element.data("jBox-animating")).data("jBox-animating",null),this.animationTimeout[options.element.data("jBox-animating-id")]&&clearTimeout(this.animationTimeout[options.element.data("jBox-animating-id")])),options.element.addClass("jBox-animated-"+animation).data("jBox-animating","jBox-animated-"+animation),this.animationTimeout[options.element.data("jBox-animating-id")]=setTimeout(function(){options.element.removeClass(options.element.data("jBox-animating")).data("jBox-animating",null),options.complete&&options.complete()},jBox._animationSpeeds[animation])},jBox.prototype.destroy=function(){return this.detach(),this.isOpen&&this.close({ignoreDelay:!0}),this.wrapper&&this.wrapper.remove(),this.overlay&&this.overlay.remove(),this._styles&&this._styles.remove(),this.isDestroyed=!0,this},jBox._getUniqueID=(i=1,function(){return i++}),jBox._getUniqueElementID=function(){var i=1;return function(){return i++}}(),jBox._pluginOptions={},jBox.plugin=function(type,options){jBox._pluginOptions[type]=options},jQuery.fn.jBox=function(type,options){return type||(type={}),options||(options={}),new jBox(type,jQuery.extend(options,{attach:this}))},jBox}),jQuery(document).ready(function(){new jBox.plugin("Confirm",{confirmButton:"Submit",cancelButton:"Cancel",confirm:null,cancel:null,closeOnConfirm:!0,target:window,fixed:!0,attach:"[data-confirm]",getContent:"data-confirm",content:"Do you really want to do this?",minWidth:360,maxWidth:500,blockScroll:!0,closeOnEsc:!0,closeOnClick:!1,closeButton:!1,overlay:!0,animation:"zoomIn",preventDefault:!0,_onAttach:function(el){if(!this.options.confirm){var submit=el.attr("onclick")?el.attr("onclick"):el.attr("href")?el.attr("target")?'window.open("'+el.attr("href")+'", "'+el.attr("target")+'");':'window.location.href = "'+el.attr("href")+'";':"";el.prop("onclick",null).data("jBox-Confirm-submit",submit)}},_onCreated:function(){this.wrapper.addClass("jBox-Modal"),this.footer=jQuery('<div class="jBox-Confirm-footer"/>'),jQuery('<div class="jBox-Confirm-button jBox-Confirm-button-cancel"/>').html(this.options.cancelButton).click(function(){this.options.cancel&&this.options.cancel(),this.close()}.bind(this)).appendTo(this.footer),this.submitButton=jQuery('<div class="jBox-Confirm-button jBox-Confirm-button-submit"/>').html(this.options.confirmButton).appendTo(this.footer),this.footer.appendTo(this.container)},_onOpen:function(){this.submitButton.off("click.jBox-Confirm"+this.id).on("click.jBox-Confirm"+this.id,function(){this.options.confirm?this.options.confirm():eval(this.source.data("jBox-Confirm-submit")),this.options.closeOnConfirm&&this.close()}.bind(this))}})}),jQuery(document).ready(function(){new jBox.plugin("Image",{src:"href",gallery:"data-jbox-image",imageLabel:"title",imageFade:360,imageSize:"contain",imageCounter:!1,imageCounterSeparator:"/",downloadButton:!1,downloadButtonText:null,downloadButtonUrl:null,mobileImageAttr:null,mobileImageBreakpoint:null,preloadFirstImage:!1,target:window,attach:"[data-jbox-image]",fixed:!0,blockScroll:!0,closeOnEsc:!0,closeOnClick:"button",closeButton:!0,overlay:!0,animation:"zoomIn",preventDefault:!0,width:"100%",height:"100%",adjustDistance:{top:40,right:5,bottom:40,left:5},_onInit:function(){this.images=this.currentImage={},this.imageZIndex=1,this.initImage=function(item){if(!(item=jQuery(item)).data("jBox-image-gallery")){var src=item.attr(this.options.src);this.options.mobileImageAttr&&this.options.mobileImageBreakpoint&&item.attr(this.options.mobileImageAttr)&&jQuery(window).width()<=this.options.mobileImageBreakpoint&&(src=item.attr(this.options.mobileImageAttr));var gallery=item.attr(this.options.gallery)||"default";this.images[gallery]||(this.images[gallery]=[]),this.images[gallery].push({src:src,label:item.attr(this.options.imageLabel)||"",downloadUrl:this.options.downloadButtonUrl&&item.attr(this.options.downloadButtonUrl)?item.attr(this.options.downloadButtonUrl):null}),"title"==this.options.imageLabel&&item.removeAttr("title"),item.data("jBox-image-gallery",gallery),item.data("jBox-image-id",this.images[gallery].length-1)}}.bind(this),this.attachedElements&&this.attachedElements.length&&jQuery.each(this.attachedElements,function(index,item){this.initImage(item)}.bind(this));var appendImage=function(gallery,id,show,instant){if(!jQuery("#jBox-image-"+gallery+"-"+id).length){var image=jQuery("<div/>",{id:"jBox-image-"+gallery+"-"+id,class:"jBox-image-container"+(show?" jBox-image-"+gallery+"-current":"")}).css({backgroundSize:this.options.imageSize,opacity:instant?1:0,zIndex:show?this.imageZIndex++:0}).appendTo(this.content);return jQuery("<div/>",{id:"jBox-image-label-"+gallery+"-"+id,class:"jBox-image-label"+(show?" active":"")}).html(this.images[gallery][id].label).click(function(){jQuery(this).toggleClass("expanded")}).appendTo(this.imageLabel),show&&image.animate({opacity:1},instant?0:this.options.imageFade),image}}.bind(this);this.downloadImage=function(imageUrl){var link=document.createElement("a");link.href=imageUrl,link.setAttribute("download",imageUrl.substring(imageUrl.lastIndexOf("/")+1)),document.body.appendChild(link),link.click()};var loadImage=function(gallery,id,show,instant){var imageContainer=appendImage(gallery,id,show,instant);imageContainer.addClass("jBox-image-loading"),jQuery('<img src="'+this.images[gallery][id].src+'" />').each(function(){var tmpImg=new Image;tmpImg.onload=function(){imageContainer.removeClass("jBox-image-loading"),imageContainer.css({backgroundImage:'url("'+this.images[gallery][id].src+'")'})}.bind(this),tmpImg.onerror=function(){imageContainer.removeClass("jBox-image-loading"),imageContainer.addClass("jBox-image-not-found")}.bind(this),tmpImg.src=this.images[gallery][id].src}.bind(this))}.bind(this);this.showImage=function(img){if("open"!=img){var gallery=this.currentImage.gallery;id=(id=this.currentImage.id+(1*("prev"==img)?-1:1))>this.images[gallery].length-1?0:id<0?this.images[gallery].length-1:id}else{if(this.source){gallery=this.source.data("jBox-image-gallery");var id=this.source.data("jBox-image-id")}else{if(!this.attachedElements||!this.attachedElements.length)return;gallery=jQuery(this.attachedElements[0]).data("jBox-image-gallery"),id=jQuery(this.attachedElements[0]).data("jBox-image-id")}jQuery(".jBox-image-pointer-prev, .jBox-image-pointer-next").css({display:1<this.images[gallery].length?"block":"none"})}if(jQuery(".jBox-image-"+gallery+"-current").length&&jQuery(".jBox-image-"+gallery+"-current").removeClass("jBox-image-"+gallery+"-current").animate({opacity:0},"open"==img?0:this.options.imageFade),this.currentImage={gallery:gallery,id:id},jQuery("#jBox-image-"+gallery+"-"+id).length?jQuery("#jBox-image-"+gallery+"-"+id).addClass("jBox-image-"+gallery+"-current").css({zIndex:this.imageZIndex++,opacity:0}).animate({opacity:1},"open"==img?0:this.options.imageFade):loadImage(gallery,id,!0,"open"===img),function(gallery,id){jQuery(".jBox-image-label.active").removeClass("active expanded"),jQuery("#jBox-image-label-"+gallery+"-"+id).addClass("active")}(gallery,id),this.imageCounter&&(1<this.images[gallery].length?(this.wrapper.addClass("jBox-image-has-counter"),this.imageCounter.find(".jBox-image-counter-all").html(this.images[gallery].length),this.imageCounter.find(".jBox-image-counter-current").html(id+1)):this.wrapper.removeClass("jBox-image-has-counter")),this.images[gallery].length-1){var next_id=id+1;next_id=next_id>this.images[gallery].length-1?0:next_id<0?this.images[gallery].length-1:next_id,jQuery("#jBox-image-"+gallery+"-"+next_id).length||loadImage(gallery,next_id,!1,!1)}},this.options.preloadFirstImage&&jQuery(window).on("load",function(){this.showImage("open")}.bind(this))},_onAttach:function(item){this.initImage&&this.initImage(item)},_onCreated:function(){this.imageLabel=jQuery("<div/>",{class:"jBox-image-label-container"}).appendTo(this.wrapper),this.imageLabel.append(jQuery("<div/>",{class:"jBox-image-pointer-prev",click:function(){this.showImage("prev")}.bind(this)})).append(jQuery("<div/>",{class:"jBox-image-pointer-next",click:function(){this.showImage("next")}.bind(this)})),this.options.downloadButton&&(this.downloadButton=jQuery("<div/>",{class:"jBox-image-download-button-wrapper"}).appendTo(this.wrapper).append(this.options.downloadButtonText?jQuery("<div/>",{class:"jBox-image-download-button-text"}).html(this.options.downloadButtonText):null).append(jQuery("<div/>",{class:"jBox-image-download-button-icon"})).on("click touchdown",function(){if(this.images[this.currentImage.gallery][this.currentImage.id].downloadUrl)var currentImageUrl=this.images[this.currentImage.gallery][this.currentImage.id].downloadUrl;else currentImageUrl=this.wrapper.find(".jBox-image-default-current")[0].style.backgroundImage.slice(4,-1).replace(/["']/g,"");this.downloadImage(currentImageUrl)}.bind(this))),this.options.imageCounter&&(this.imageCounter=jQuery("<div/>",{class:"jBox-image-counter-container"}).appendTo(this.wrapper),this.imageCounter.append(jQuery("<span/>",{class:"jBox-image-counter-current"})).append(jQuery("<span/>").html(this.options.imageCounterSeparator)).append(jQuery("<span/>",{class:"jBox-image-counter-all"})))},_onOpen:function(){jQuery(document).on("keyup.jBox-Image-"+this.id,function(ev){37==ev.keyCode&&this.showImage("prev"),39==ev.keyCode&&this.showImage("next")}.bind(this)),this.showImage("open")},_onClose:function(){jQuery(document).off("keyup.jBox-Image-"+this.id)},_onCloseComplete:function(){this.wrapper.find(".jBox-image-container").css("opacity",0)}})}),jQuery(document).ready(function(){new jBox.plugin("Notice",{color:null,stack:!0,stackSpacing:10,autoClose:6e3,attributes:{x:"right",y:"top"},position:{x:15,y:15},responsivePositions:{500:{x:5,y:5},768:{x:10,y:10}},target:window,fixed:!0,animation:"zoomIn",closeOnClick:"box",zIndex:12e3,_onInit:function(){this.defaultNoticePosition=jQuery.extend({},this.options.position),this._adjustNoticePositon=function(){var win=jQuery(window),windowDimensions_x=win.width();win.height();this.options.position=jQuery.extend({},this.defaultNoticePosition),jQuery.each(this.options.responsivePositions,function(viewport,position){if(windowDimensions_x<=viewport)return this.options.position=position,!1}.bind(this)),this.options.adjustDistance={top:this.options.position.y,right:this.options.position.x,bottom:this.options.position.y,left:this.options.position.x}},this.options.content instanceof jQuery&&(this.options.content=this.options.content.clone().attr("id","")),jQuery(window).on("resize.responsivejBoxNotice-"+this.id,function(ev){this.isOpen&&this._adjustNoticePositon()}.bind(this)),this.open()},_onCreated:function(){this.wrapper.addClass("jBox-Notice-color jBox-Notice-"+(this.options.color||"gray")),this.wrapper.data("jBox-Notice-position",this.options.attributes.x+"-"+this.options.attributes.y)},_onOpen:function(){this.options.stack||(this._adjustNoticePositon(),jQuery.each(jQuery(".jBox-Notice"),function(index,el){(el=jQuery(el)).attr("id")!=this.id&&el.data("jBox-Notice-position")==this.options.attributes.x+"-"+this.options.attributes.y&&(this.options.stack||el.data("jBox").close({ignoreDelay:!0}))}.bind(this)))},_onPosition:function(){var stacks={};for(var pos in jQuery.each(jQuery(".jBox-Notice"),function(index,el){var pos=(el=jQuery(el)).data("jBox-Notice-position");stacks[pos]||(stacks[pos]=[]),stacks[pos].push(el)}),stacks){var direction=pos.split("-")[1];stacks[pos].reverse();var margin=0;for(var i in stacks[pos])el=stacks[pos][i],el.css("margin-"+direction,margin),margin+=el.outerHeight()+this.options.stackSpacing}},_onCloseComplete:function(){this.destroy(),this.options._onPosition.bind(this).call()}})});